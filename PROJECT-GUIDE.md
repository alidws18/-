# ğŸ“˜ Ø§Ù„Ø¯Ù„ÙŠÙ„ Ø§Ù„Ø´Ø§Ù…Ù„ Ù„Ù„Ù…Ø´Ø±ÙˆØ¹
## Ù†Ø¸Ø§Ù… Ø§Ù„ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ù…Ø±ÙƒØ²ÙŠ Ù„Ø¥Ø¯Ø§Ø±Ø© Ø®Ø¯Ù…Ø© Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡

---

## ğŸ“‘ ÙÙ‡Ø±Ø³ Ø§Ù„Ù…Ø­ØªÙˆÙŠØ§Øª

1. [Ù†Ø¸Ø±Ø© Ø¹Ø§Ù…Ø© Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹](#Ù†Ø¸Ø±Ø©-Ø¹Ø§Ù…Ø©)
2. [Ø¨Ù†ÙŠØ© Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª](#Ø¨Ù†ÙŠØ©-Ù‚Ø§Ø¹Ø¯Ø©-Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª)
3. [Ù‡ÙŠÙƒÙ„ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹](#Ù‡ÙŠÙƒÙ„-Ø§Ù„Ù…Ø´Ø±ÙˆØ¹)
4. [Ø§Ù„Ù…Ù„ÙØ§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©](#Ø§Ù„Ù…Ù„ÙØ§Øª-Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©)
5. [Ø³ÙŠØ± Ø§Ù„Ø¹Ù…Ù„](#Ø³ÙŠØ±-Ø§Ù„Ø¹Ù…Ù„)
6. [Ø§Ù„Ø£Ù…Ø«Ù„Ø© Ø§Ù„Ø¹Ù…Ù„ÙŠØ©](#Ø§Ù„Ø£Ù…Ø«Ù„Ø©-Ø§Ù„Ø¹Ù…Ù„ÙŠØ©)
7. [Ù†ØµØ§Ø¦Ø­ Ø§Ù„ØªØ·ÙˆÙŠØ±](#Ù†ØµØ§Ø¦Ø­-Ø§Ù„ØªØ·ÙˆÙŠØ±)

---

## ğŸ¯ Ù†Ø¸Ø±Ø© Ø¹Ø§Ù…Ø©

### Ø§Ù„Ù‡Ø¯Ù
Ù†Ø¸Ø§Ù… Ø´Ø§Ù…Ù„ Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØªÙ‚ÙŠÙŠÙ…Ø§Øª ÙÙŠ Ø§Ù„Ø¬Ù‡Ø§Øª Ø§Ù„Ø­ÙƒÙˆÙ…ÙŠØ© ÙŠØ¯Ø¹Ù…:
- Ø¥Ù†Ø´Ø§Ø¡ Ù†Ù…Ø§Ø°Ø¬ ØªÙ‚ÙŠÙŠÙ… Ù…Ø±Ù†Ø©
- ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ù…Ø±Ø§ÙƒØ² Ø¹Ø¨Ø± Ø²ÙŠØ§Ø±Ø§Øª Ù…ÙŠØ¯Ø§Ù†ÙŠØ©
- ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ù…Ø¯ÙŠØ±ÙŠÙ† Ù„Ù„Ù…ÙˆØ¸ÙÙŠÙ†
- Ø§Ù„ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ø°Ø§ØªÙŠ Ù„Ù„Ù…ÙˆØ¸ÙÙŠÙ†
- ØªÙ‚Ø§Ø±ÙŠØ± ÙˆØ¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø´Ø§Ù…Ù„Ø©

### Ø§Ù„ØªÙ‚Ù†ÙŠØ§Øª
```
Frontend:  React 18 + Vite + Tailwind CSS + Recharts
Backend:   Supabase (PostgreSQL + Auth + RLS)
Deploy:    Netlify
Security:  Row Level Security + Audit Logs
```

---

## ğŸ—„ï¸ Ø¨Ù†ÙŠØ© Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª

### Ø§Ù„Ø¬Ø¯Ø§ÙˆÙ„ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© (11 Ø¬Ø¯ÙˆÙ„)

#### 1. roles - Ø§Ù„Ø£Ø¯ÙˆØ§Ø±
```sql
- id: UUID (PK)
- name: VARCHAR(50) - Ø§Ø³Ù… Ø§Ù„Ø¯ÙˆØ± Ø¨Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©
- name_ar: VARCHAR(100) - Ø§Ø³Ù… Ø§Ù„Ø¯ÙˆØ± Ø¨Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©
- description: TEXT
```

**Ø§Ù„Ø£Ø¯ÙˆØ§Ø± Ø§Ù„Ù…Ø¹Ø±Ù‘ÙØ©:**
- admin: Ù…Ø¯ÙŠØ± Ø§Ù„Ù†Ø¸Ø§Ù…
- manager: Ù…Ø¯ÙŠØ± Ù‚Ø³Ù…
- employee: Ù…ÙˆØ¸Ù
- reviewer: Ù…Ø±Ø§Ø¬Ø¹

#### 2. users - Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙˆÙ†
```sql
- id: UUID (PK) â†’ REFERENCES auth.users
- role_id: UUID â†’ REFERENCES roles
- center_id: UUID â†’ REFERENCES centers
- full_name: VARCHAR(200)
- email: VARCHAR(255) UNIQUE
- phone: VARCHAR(20)
- employee_number: VARCHAR(50) UNIQUE
- is_active: BOOLEAN
```

**Ø§Ù„Ø¹Ù„Ø§Ù‚Ø§Øª:**
- ÙŠÙ†ØªÙ…ÙŠ Ù„Ø¯ÙˆØ± ÙˆØ§Ø­Ø¯
- Ù‚Ø¯ ÙŠÙ†ØªÙ…ÙŠ Ù„Ù…Ø±ÙƒØ² ÙˆØ§Ø­Ø¯
- Ù…Ø±ØªØ¨Ø· Ù…Ø¹ Supabase Auth

#### 3. centers - Ø§Ù„Ù…Ø±Ø§ÙƒØ²
```sql
- id: UUID (PK)
- code: VARCHAR(50) UNIQUE
- name: VARCHAR(200)
- name_ar: VARCHAR(200)
- location: TEXT
- manager_id: UUID â†’ REFERENCES users
- is_active: BOOLEAN
```

#### 4. employees - Ø§Ù„Ù…ÙˆØ¸ÙÙˆÙ†
```sql
- id: UUID (PK)
- user_id: UUID â†’ REFERENCES users (UNIQUE)
- center_id: UUID â†’ REFERENCES centers
- manager_id: UUID â†’ REFERENCES users
- position: VARCHAR(100)
- position_ar: VARCHAR(100)
- department: VARCHAR(100)
- department_ar: VARCHAR(100)
- hire_date: DATE
- is_active: BOOLEAN
```

#### 5. forms - Ø§Ù„Ù†Ù…Ø§Ø°Ø¬
```sql
- id: UUID (PK)
- code: VARCHAR(50) UNIQUE
- title: VARCHAR(200)
- title_ar: VARCHAR(200)
- description: TEXT
- form_type: VARCHAR(50)
  * 'center_visit' - Ø²ÙŠØ§Ø±Ø© Ù…ÙŠØ¯Ø§Ù†ÙŠØ©
  * 'manager_evaluation' - ØªÙ‚ÙŠÙŠÙ… Ù…Ø¯ÙŠØ±
  * 'self_evaluation' - ØªÙ‚ÙŠÙŠÙ… Ø°Ø§ØªÙŠ
- target_role_id: UUID â†’ REFERENCES roles
- max_score: DECIMAL(10,2)
- is_active: BOOLEAN
```

#### 6. questions - Ø§Ù„Ø£Ø³Ø¦Ù„Ø©
```sql
- id: UUID (PK)
- form_id: UUID â†’ REFERENCES forms
- question_number: INTEGER
- question_text: TEXT
- question_text_ar: TEXT
- question_type: VARCHAR(30)
  * 'yes_no' - Ù†Ø¹Ù…/Ù„Ø§
  * 'scale' - Ù…Ù‚ÙŠØ§Ø³ Ø¯Ø±Ø¬Ø§Øª
  * 'multiple_choice' - Ø§Ø®ØªÙŠØ§Ø± Ù…ØªØ¹Ø¯Ø¯
  * 'text' - Ù†Øµ Ø­Ø±
- weight: DECIMAL(5,2) - Ø§Ù„ÙˆØ²Ù† Ø§Ù„Ù†Ø³Ø¨ÙŠ
- max_points: DECIMAL(10,2)
- options: JSONB - Ù„Ù„Ø§Ø®ØªÙŠØ§Ø±Ø§Øª Ø§Ù„Ù…ØªØ¹Ø¯Ø¯Ø©
- is_required: BOOLEAN
- order_index: INTEGER
```

#### 7. visits - Ø§Ù„Ø²ÙŠØ§Ø±Ø§Øª Ø§Ù„Ù…ÙŠØ¯Ø§Ù†ÙŠØ©
```sql
- id: UUID (PK)
- center_id: UUID â†’ REFERENCES centers
- visit_number: INTEGER (1 or 2)
- visit_date: DATE
- visitor_id: UUID â†’ REFERENCES users
- visit_month: INTEGER (1-12)
- visit_year: INTEGER
- status: VARCHAR(30)
  * 'scheduled' - Ù…Ø¬Ø¯ÙˆÙ„Ø©
  * 'in_progress' - Ø¬Ø§Ø±ÙŠØ©
  * 'completed' - Ù…ÙƒØªÙ…Ù„Ø©
  * 'cancelled' - Ù…Ù„ØºØ§Ø©
- notes: TEXT
```

**Ù‚ÙŠÙˆØ¯:**
- UNIQUE(center_id, visit_year, visit_month, visit_number)
- Ø²ÙŠØ§Ø±ØªÙŠÙ† ÙÙ‚Ø· Ù„ÙƒÙ„ Ù…Ø±ÙƒØ² Ø´Ù‡Ø±ÙŠØ§Ù‹

#### 8. evaluations - Ø§Ù„ØªÙ‚ÙŠÙŠÙ…Ø§Øª
```sql
- id: UUID (PK)
- form_id: UUID â†’ REFERENCES forms
- evaluator_id: UUID â†’ REFERENCES users
- evaluated_user_id: UUID â†’ REFERENCES users (nullable)
- evaluated_center_id: UUID â†’ REFERENCES centers (nullable)
- visit_id: UUID â†’ REFERENCES visits (nullable)
- evaluation_date: DATE
- total_score: DECIMAL(10,2) - Ù…Ø­Ø³ÙˆØ¨Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹
- percentage: DECIMAL(5,2) - Ù…Ø­Ø³ÙˆØ¨Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹
- status: VARCHAR(30)
  * 'draft' - Ù…Ø³ÙˆØ¯Ø©
  * 'submitted' - Ù…Ø±Ø³Ù„Ø©
  * 'approved' - Ù…ÙˆØ§ÙÙ‚ Ø¹Ù„ÙŠÙ‡Ø§
  * 'rejected' - Ù…Ø±ÙÙˆØ¶Ø©
- notes: TEXT
- submitted_at: TIMESTAMP
```

#### 9. answers - Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø§Øª
```sql
- id: UUID (PK)
- evaluation_id: UUID â†’ REFERENCES evaluations
- question_id: UUID â†’ REFERENCES questions
- answer_value: TEXT
- score: DECIMAL(10,2)
- notes: TEXT
```

**Ù‚ÙŠÙˆØ¯:**
- UNIQUE(evaluation_id, question_id)

#### 10. reports - Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± (Ù…Ø¤Ù‚ØªØ©)
```sql
- id: UUID (PK)
- report_type: VARCHAR(50)
- report_period: VARCHAR(50)
- start_date: DATE
- end_date: DATE
- filters: JSONB
- data: JSONB
- generated_by: UUID â†’ REFERENCES users
- generated_at: TIMESTAMP
```

#### 11. audit_logs - Ø³Ø¬Ù„ Ø§Ù„ØªØ¯Ù‚ÙŠÙ‚
```sql
- id: UUID (PK)
- user_id: UUID â†’ REFERENCES users
- action: VARCHAR(100) - INSERT/UPDATE/DELETE
- table_name: VARCHAR(100)
- record_id: UUID
- old_values: JSONB
- new_values: JSONB
- ip_address: INET
- created_at: TIMESTAMP
```

### Ø§Ù„Ø¹Ø±ÙˆØ¶ (Views) Ù„Ù„ØªÙ‚Ø§Ø±ÙŠØ±

#### v_center_rankings
```sql
SELECT 
  center_id,
  code,
  name_ar,
  total_evaluations,
  avg_percentage,
  last_evaluation_date,
  ranking
FROM centers + evaluations
ORDER BY avg_percentage DESC
```

#### v_manager_compliance
```sql
SELECT 
  manager_id,
  full_name,
  center_name,
  evaluations_count,
  submitted_count,
  compliance_status ('Ù…Ù„ØªØ²Ù…' / 'ØºÙŠØ± Ù…Ù„ØªØ²Ù…' / 'Ø§Ù„ØªØ²Ø§Ù… Ø¬Ø²Ø¦ÙŠ')
FROM users + evaluations
```

#### v_employee_submission_status
```sql
SELECT 
  employee_id,
  full_name,
  center_name,
  manager_name,
  total_submissions,
  last_submission_date,
  submission_status ('ØªÙ… Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„' / 'Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„')
FROM employees + evaluations
```

### Ø§Ù„Ø¯ÙˆØ§Ù„ (Functions)

#### calculate_evaluation_score()
```sql
TRIGGER: Ø¨Ø¹Ø¯ Ø¥Ø¶Ø§ÙØ©/ØªØ¹Ø¯ÙŠÙ„ Ø¥Ø¬Ø§Ø¨Ø©
ÙŠØ­Ø³Ø¨ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹:
- total_score = SUM(answers.score)
- percentage = (total_score / max_score) * 100
```

#### get_user_role()
```sql
RETURNS: Ø§Ø³Ù… Ø¯ÙˆØ± Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø­Ø§Ù„ÙŠ
```

#### is_admin() / is_manager()
```sql
RETURNS: BOOLEAN
Ù„Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµÙ„Ø§Ø­ÙŠØ§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
```

---

## ğŸ“‚ Ù‡ÙŠÙƒÙ„ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹

```
gov-evaluation-system/
â”‚
â”œâ”€â”€ database-schema.sql          â† Ø¥Ù†Ø´Ø§Ø¡ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
â”œâ”€â”€ rls-policies.sql             â† Ø³ÙŠØ§Ø³Ø§Øª Ø§Ù„Ø£Ù…Ø§Ù†
â”œâ”€â”€ README.md                    â† Ø§Ù„Ø¯Ù„ÙŠÙ„ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ
â”œâ”€â”€ DEPLOYMENT.md                â† Ø¯Ù„ÙŠÙ„ Ø§Ù„Ù†Ø´Ø±
â”œâ”€â”€ QUICKSTART.md                â† Ø¯Ù„ÙŠÙ„ Ø§Ù„Ø¨Ø¯Ø¡ Ø§Ù„Ø³Ø±ÙŠØ¹
â”œâ”€â”€ PROJECT-GUIDE.md             â† Ù‡Ø°Ø§ Ø§Ù„Ù…Ù„Ù
â”‚
â”œâ”€â”€ package.json                 â† Ø§Ù„Ø­Ø²Ù… ÙˆØ§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª
â”œâ”€â”€ vite.config.js               â† Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Vite
â”œâ”€â”€ tailwind.config.js           â† Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Tailwind
â”œâ”€â”€ postcss.config.js            â† Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª PostCSS
â”œâ”€â”€ netlify.toml                 â† Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Netlify
â”‚
â”œâ”€â”€ .env.example                 â† Ù†Ù…ÙˆØ°Ø¬ Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ø¨ÙŠØ¦Ø©
â”œâ”€â”€ .gitignore                   â† Ù…Ù„ÙØ§Øª Ù…ØªØ¬Ø§Ù‡Ù„Ø©
â”‚
â”œâ”€â”€ index.html                   â† Ù…Ù„Ù HTML Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ
â”‚
â””â”€â”€ src/
    â”œâ”€â”€ main.jsx                 â† Ù†Ù‚Ø·Ø© Ø§Ù„Ø¯Ø®ÙˆÙ„
    â”œâ”€â”€ App.jsx                  â† Ø§Ù„Ù…ÙƒÙˆÙ† Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ + Routing
    â”œâ”€â”€ index.css                â† Ø§Ù„Ø£Ù†Ù…Ø§Ø· Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
    â”‚
    â”œâ”€â”€ contexts/
    â”‚   â””â”€â”€ AuthContext.jsx      â† Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø©
    â”‚
    â”œâ”€â”€ services/
    â”‚   â””â”€â”€ supabase.js          â† Supabase Client
    â”‚
    â”œâ”€â”€ pages/
    â”‚   â”œâ”€â”€ Login.jsx            â† ØµÙØ­Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
    â”‚   â”œâ”€â”€ AdminDashboard.jsx   â† Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø§Ù„Ù…Ø¯ÙŠØ±
    â”‚   â”œâ”€â”€ ManagerDashboard.jsx â† Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø§Ù„Ù…Ø¯ÙŠØ±
    â”‚   â”œâ”€â”€ EmployeeDashboard.jsxâ† Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø§Ù„Ù…ÙˆØ¸Ù
    â”‚   â”œâ”€â”€ ReviewerDashboard.jsxâ† Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹
    â”‚   â”œâ”€â”€ EvaluationForm.jsx   â† ØµÙØ­Ø© Ø§Ù„ØªÙ‚ÙŠÙŠÙ…
    â”‚   â”œâ”€â”€ ReportsPage.jsx      â† ØµÙØ­Ø© Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±
    â”‚   â””â”€â”€ admin/
    â”‚       â”œâ”€â”€ FormsManagement.jsx      â† Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù†Ù…Ø§Ø°Ø¬
    â”‚       â”œâ”€â”€ CentersManagement.jsx    â† Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø±Ø§ÙƒØ²
    â”‚       â”œâ”€â”€ UsersManagement.jsx      â† Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†
    â”‚       â””â”€â”€ VisitsManagement.jsx     â† Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø²ÙŠØ§Ø±Ø§Øª
    â”‚
    â””â”€â”€ components/
        â”œâ”€â”€ common/
        â”‚   â”œâ”€â”€ Navbar.jsx       â† Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ†Ù‚Ù„
        â”‚   â””â”€â”€ LoadingSpinner.jsxâ† Ù…Ø¤Ø´Ø± Ø§Ù„ØªØ­Ù…ÙŠÙ„
        â”‚
        â”œâ”€â”€ admin/               â† Ù…ÙƒÙˆÙ†Ø§Øª Ø§Ù„Ù…Ø¯ÙŠØ±
        â”œâ”€â”€ manager/             â† Ù…ÙƒÙˆÙ†Ø§Øª Ø§Ù„Ù…Ø¯ÙŠØ±
        â”œâ”€â”€ employee/            â† Ù…ÙƒÙˆÙ†Ø§Øª Ø§Ù„Ù…ÙˆØ¸Ù
        â””â”€â”€ reports/             â† Ù…ÙƒÙˆÙ†Ø§Øª Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±
```

---

## ğŸ“„ Ø§Ù„Ù…Ù„ÙØ§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©

### 1. AuthContext.jsx - Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø©

```javascript
// Ø§Ù„ÙˆØ¸Ø§Ø¦Ù Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©:
- signIn(email, password)       // ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
- signOut()                      // ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬
- signUp(email, password, data)  // Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨
- resetPassword(email)           // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±

// Ø§Ù„Ø­Ø§Ù„Ø©:
- user         // Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…Ù† Supabase Auth
- profile      // Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„ÙƒØ§Ù…Ù„Ø© + Ø¯ÙˆØ± + Ù…Ø±ÙƒØ²
- loading      // Ø­Ø§Ù„Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„
- isAdmin      // boolean
- isManager    // boolean
- isEmployee   // boolean
- isReviewer   // boolean
```

### 2. supabase.js - Ø®Ø¯Ù…Ø© Supabase

```javascript
// Ø§Ù„ÙˆØ¸Ø§Ø¦Ù:
- getCurrentUser()      // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø­Ø§Ù„ÙŠ
- getUserRole()         // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø¯ÙˆØ± Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
- isAdmin()             // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙƒÙˆÙ†Ù‡ Ù…Ø¯ÙŠØ±
- isManager()           // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙƒÙˆÙ†Ù‡ Ù…Ø¯ÙŠØ± Ù‚Ø³Ù…

// Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…:
import { supabase, db } from '@/services/supabase'

// Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø¨ÙŠØ§Ù†Ø§Øª
const { data, error } = await supabase
  .from('centers')
  .select('*')
  .eq('is_active', true)

// Ø¥Ø¶Ø§ÙØ© Ø¨ÙŠØ§Ù†Ø§Øª
const { data, error } = await supabase
  .from('centers')
  .insert({ name_ar: 'Ù…Ø±ÙƒØ² Ø¬Ø¯ÙŠØ¯', ... })

// ØªØ­Ø¯ÙŠØ«
const { data, error } = await supabase
  .from('centers')
  .update({ name_ar: 'Ø§Ø³Ù… Ù…Ø­Ø¯Ø«' })
  .eq('id', centerId)
```

### 3. App.jsx - Ø§Ù„ØªÙˆØ¬ÙŠÙ‡

```javascript
// Ø§Ù„Ù…Ø³Ø§Ø±Ø§Øª:
/login                   â†’ Login page
/                        â†’ Dashboard (Ø­Ø³Ø¨ Ø§Ù„Ø¯ÙˆØ±)
/admin/forms             â†’ FormsManagement (admin only)
/admin/centers           â†’ CentersManagement (admin only)
/admin/users             â†’ UsersManagement (admin only)
/admin/visits            â†’ VisitsManagement (admin/reviewer)
/reports                 â†’ ReportsPage (all except employee)
/evaluation/:formId      â†’ EvaluationForm (all)

// ProtectedRoute - Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª
<ProtectedRoute allowedRoles={['admin', 'reviewer']}>
  <Component />
</ProtectedRoute>
```

---

## ğŸ”„ Ø³ÙŠØ± Ø§Ù„Ø¹Ù…Ù„

### Ø³ÙŠÙ†Ø§Ø±ÙŠÙˆ 1: Ø¥Ù†Ø´Ø§Ø¡ Ù†Ù…ÙˆØ°Ø¬ ØªÙ‚ÙŠÙŠÙ… Ø¬Ø¯ÙŠØ¯

```
1. Ø§Ù„Ù…Ø¯ÙŠØ± â† Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù†Ù…Ø§Ø°Ø¬
2. Ø¥Ù†Ø´Ø§Ø¡ Ù†Ù…ÙˆØ°Ø¬ Ø¬Ø¯ÙŠØ¯
   - Ø§Ù„Ø¹Ù†ÙˆØ§Ù†
   - Ø§Ù„Ù†ÙˆØ¹ (Ø²ÙŠØ§Ø±Ø©/Ù…Ø¯ÙŠØ±/Ø°Ø§ØªÙŠ)
   - Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰ Ù„Ù„Ø¯Ø±Ø¬Ø©
3. Ø¥Ø¶Ø§ÙØ© Ø£Ø³Ø¦Ù„Ø©:
   - Ù†Øµ Ø§Ù„Ø³Ø¤Ø§Ù„
   - Ø§Ù„Ù†ÙˆØ¹
   - Ø§Ù„ÙˆØ²Ù† Ø§Ù„Ù†Ø³Ø¨ÙŠ
   - Ø§Ù„Ø¯Ø±Ø¬Ø©
4. Ø­ÙØ¸ â† ÙŠÙÙ†Ø´Ø£ ÙÙŠ forms + questions
```

### Ø³ÙŠÙ†Ø§Ø±ÙŠÙˆ 2: ØªÙ‚ÙŠÙŠÙ… Ù…ÙˆØ¸Ù

```
1. Ø§Ù„Ù…Ø¯ÙŠØ± â† Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…
2. ÙŠØ±Ù‰ Ù‚Ø§Ø¦Ù…Ø© Ù…ÙˆØ¸ÙÙŠÙ‡ (Ù…Ù† employees Ø­ÙŠØ« manager_id = current_user)
3. ÙŠÙ†Ù‚Ø± "ØªÙ‚ÙŠÙŠÙ…" â† ÙŠØ®ØªØ§Ø± Ø§Ù„Ù†Ù…ÙˆØ°Ø¬
4. ÙŠÙÙ†Ø´Ø£ evaluation Ø¬Ø¯ÙŠØ¯:
   - evaluator_id = current_user
   - evaluated_user_id = employee
   - status = 'draft'
5. ÙŠØ¬ÙŠØ¨ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© â† ØªÙØ­ÙØ¸ ÙÙŠ answers
6. Trigger ÙŠØ­Ø³Ø¨ total_score Ùˆ percentage ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹
7. ÙŠÙ†Ù‚Ø± "Ø¥Ø±Ø³Ø§Ù„" â† status = 'submitted'
```

### Ø³ÙŠÙ†Ø§Ø±ÙŠÙˆ 3: Ø²ÙŠØ§Ø±Ø© Ù…ÙŠØ¯Ø§Ù†ÙŠØ©

```
1. Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹ â† Ø§Ù„Ø²ÙŠØ§Ø±Ø§Øª Ø§Ù„Ù…ÙŠØ¯Ø§Ù†ÙŠØ©
2. Ø¥Ù†Ø´Ø§Ø¡ Ø²ÙŠØ§Ø±Ø©:
   - Ø§Ù„Ù…Ø±ÙƒØ²
   - Ø§Ù„ØªØ§Ø±ÙŠØ®
   - Ø±Ù‚Ù… Ø§Ù„Ø²ÙŠØ§Ø±Ø© (1 Ø£Ùˆ 2)
3. ÙŠÙÙ†Ø´Ø£ visit Ù…Ø¹ status = 'scheduled'
4. Ø¹Ù†Ø¯ Ø§Ù„Ø²ÙŠØ§Ø±Ø© â† ÙŠÙØªØ­ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬
5. ÙŠÙÙ†Ø´Ø£ evaluation:
   - visit_id = current_visit
   - evaluated_center_id = center
6. ÙŠØ¬ÙŠØ¨ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ø³Ø¦Ù„Ø©
7. ÙŠØ±Ø³Ù„ â† visit.status = 'completed'
```

### Ø³ÙŠÙ†Ø§Ø±ÙŠÙˆ 4: Ø¥Ù†Ø´Ø§Ø¡ ØªÙ‚Ø±ÙŠØ±

```
1. Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… â† Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±
2. ÙŠØ®ØªØ§Ø± Ù†ÙˆØ¹ Ø§Ù„ØªÙ‚Ø±ÙŠØ±:
   - ØªØ±ØªÙŠØ¨ Ø§Ù„Ù…Ø±Ø§ÙƒØ²
   - Ø§Ù„ØªØ²Ø§Ù… Ø§Ù„Ù…Ø¯ÙŠØ±ÙŠÙ†
   - Ø­Ø§Ù„Ø© Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†
3. ÙŠØ®ØªØ§Ø± Ø§Ù„ÙØªØ±Ø© (Ø´Ù‡Ø±/Ø±Ø¨Ø¹ Ø³Ù†ÙˆÙŠ/Ø³Ù†ÙˆÙŠ)
4. ÙŠÙØ³ØªØ¹Ù„Ù… Ù…Ù† Views Ø£Ùˆ Evaluations Ù…Ø¨Ø§Ø´Ø±Ø©
5. ÙŠÙØ¹Ø±Ø¶ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ ÙÙŠ:
   - Ø¬Ø¯Ø§ÙˆÙ„
   - Ø±Ø³ÙˆÙ… Ø¨ÙŠØ§Ù†ÙŠØ© (Recharts)
6. ÙŠÙØµØ¯Ù‘Ø±:
   - PDF (jsPDF)
   - Excel (XLSX)
```

---

## ğŸ’¡ Ø§Ù„Ø£Ù…Ø«Ù„Ø© Ø§Ù„Ø¹Ù…Ù„ÙŠØ©

### Ù…Ø«Ø§Ù„ 1: Ø¥Ø¶Ø§ÙØ© Ù…Ø±ÙƒØ² Ø¬Ø¯ÙŠØ¯

```javascript
// ÙÙŠ CentersManagement.jsx

const handleAddCenter = async (formData) => {
  try {
    const { data, error } = await supabase
      .from('centers')
      .insert({
        code: formData.code,
        name: formData.name,
        name_ar: formData.nameAr,
        location: formData.location,
        is_active: true
      })
      .select()
      .single()

    if (error) throw error
    
    // ÙŠÙØ³Ø¬Ù‘Ù„ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ ÙÙŠ audit_logs Ø¹Ø¨Ø± Trigger
    alert('ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø±ÙƒØ² Ø¨Ù†Ø¬Ø§Ø­')
    loadCenters() // Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„
  } catch (error) {
    console.error('Error:', error)
    alert('Ø®Ø·Ø£ ÙÙŠ Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø±ÙƒØ²')
  }
}
```

### Ù…Ø«Ø§Ù„ 2: ØªØ­Ù…ÙŠÙ„ ØªÙ‚ÙŠÙŠÙ…Ø§Øª Ø§Ù„Ù…ÙˆØ¸Ù

```javascript
// ÙÙŠ EmployeeDashboard.jsx

const loadEvaluations = async () => {
  const { data, error } = await supabase
    .from('evaluations')
    .select(`
      *,
      form:forms(title_ar)
    `)
    .eq('evaluator_id', profile.id)
    .order('created_at', { ascending: false })

  if (error) {
    console.error(error)
    return
  }

  setEvaluations(data)
}
```

### Ù…Ø«Ø§Ù„ 3: Ø­Ø³Ø§Ø¨ ØªØ±ØªÙŠØ¨ Ø§Ù„Ù…Ø±Ø§ÙƒØ²

```javascript
// ÙÙŠ ReportsPage.jsx

const loadCenterRankings = async (period) => {
  const { data, error } = await supabase
    .from('v_center_rankings')  // Ø§Ø³ØªØ®Ø¯Ø§Ù… View Ø¬Ø§Ù‡Ø²
    .select('*')
    .order('ranking', { ascending: true })
    .limit(10)

  if (error) {
    console.error(error)
    return
  }

  setRankings(data)
}
```

### Ù…Ø«Ø§Ù„ 4: ØªØµØ¯ÙŠØ± ØªÙ‚Ø±ÙŠØ± PDF

```javascript
// ÙÙŠ ReportsPage.jsx

import jsPDF from 'jspdf'
import 'jspdf-autotable'

const exportPDF = (data) => {
  const doc = new jsPDF({
    orientation: 'landscape',
    unit: 'mm',
    format: 'a4'
  })

  // Ø¥Ø¶Ø§ÙØ© Ø®Ø· Ø¹Ø±Ø¨ÙŠ (ÙŠØ¬Ø¨ ØªØ­Ù…ÙŠÙ„Ù‡ Ø£ÙˆÙ„Ø§Ù‹)
  doc.setFont('Cairo')
  
  // Ø§Ù„Ø¹Ù†ÙˆØ§Ù†
  doc.setFontSize(16)
  doc.text('ØªÙ‚Ø±ÙŠØ± ØªØ±ØªÙŠØ¨ Ø§Ù„Ù…Ø±Ø§ÙƒØ²', 14, 15)
  
  // Ø§Ù„Ø¬Ø¯ÙˆÙ„
  doc.autoTable({
    startY: 25,
    head: [['Ø§Ù„ØªØ±ØªÙŠØ¨', 'Ø§Ù„Ù…Ø±ÙƒØ²', 'Ø§Ù„Ù†Ø³Ø¨Ø© Ø§Ù„Ù…Ø¦ÙˆÙŠØ©']],
    body: data.map(row => [
      row.ranking,
      row.name_ar,
      `${row.avg_percentage.toFixed(1)}%`
    ]),
    styles: { font: 'Cairo' }
  })
  
  doc.save('center-rankings.pdf')
}
```

---

## ğŸ”§ Ù†ØµØ§Ø¦Ø­ Ø§Ù„ØªØ·ÙˆÙŠØ±

### 1. Ø§Ø³ØªØ®Ø¯Ø§Ù… RLS Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­

```javascript
// âŒ Ø®Ø·Ø£: Ù…Ø­Ø§ÙˆÙ„Ø© Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø®Ø§Ø±Ø¬ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª
const { data } = await supabase
  .from('users')
  .select('*')  // Ø³ÙŠØ¹ÙŠØ¯ ÙÙ‚Ø· Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³Ù…ÙˆØ­ Ø¨Ù‡Ø§ Ø­Ø³Ø¨ RLS

// âœ… ØµØ­ÙŠØ­: Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª Ø£ÙˆÙ„Ø§Ù‹
const isAdmin = await db.isAdmin()
if (!isAdmin) {
  alert('ØºÙŠØ± Ù…ØµØ±Ø­')
  return
}
```

### 2. Ø§Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ø§Ù„Ø£Ø®Ø·Ø§Ø¡

```javascript
// âœ… Ø¯Ø§Ø¦Ù…Ø§Ù‹ ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø£Ø®Ø·Ø§Ø¡
const { data, error } = await supabase
  .from('centers')
  .select('*')

if (error) {
  console.error('Supabase error:', error)
  // Ø§Ø¹Ø±Ø¶ Ø±Ø³Ø§Ù„Ø© Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…
  setErrorMessage('Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª')
  return
}

// Ø§Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
setData(data)
```

### 3. ØªØ­Ø³ÙŠÙ† Ø§Ù„Ø£Ø¯Ø§Ø¡

```javascript
// âŒ ØªØ­Ù…ÙŠÙ„ ÙƒÙ„ Ø´ÙŠØ¡
const { data } = await supabase
  .from('evaluations')
  .select('*')

// âœ… ØªØ­Ù…ÙŠÙ„ Ù…Ø§ ØªØ­ØªØ§Ø¬Ù‡ ÙÙ‚Ø·
const { data } = await supabase
  .from('evaluations')
  .select('id, total_score, percentage, status')
  .eq('status', 'submitted')
  .order('created_at', { ascending: false })
  .limit(20)
```

### 4. Ø§Ø³ØªØ®Ø¯Ø§Ù… Transactions

```javascript
// Ù„Ù„Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„Ù…Ø¹Ù‚Ø¯Ø©ØŒ Ø§Ø³ØªØ®Ø¯Ù… Supabase RPC Functions
// Ø£Ù†Ø´Ø¦ function ÙÙŠ SQL:

CREATE OR REPLACE FUNCTION complete_evaluation(eval_id UUID)
RETURNS void AS $$
BEGIN
  -- ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªÙ‚ÙŠÙŠÙ…
  UPDATE evaluations 
  SET status = 'submitted', submitted_at = NOW()
  WHERE id = eval_id;
  
  -- ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø²ÙŠØ§Ø±Ø© Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ù…ÙˆØ¬ÙˆØ¯Ø©
  UPDATE visits 
  SET status = 'completed'
  WHERE id = (SELECT visit_id FROM evaluations WHERE id = eval_id);
END;
$$ LANGUAGE plpgsql;

// Ø«Ù… ÙÙŠ React:
const { error } = await supabase
  .rpc('complete_evaluation', { eval_id: evaluationId })
```

### 5. Real-time Updates (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)

```javascript
// Ø§Ù„Ø§Ø³ØªÙ…Ø§Ø¹ Ù„Ù„ØªØºÙŠÙŠØ±Ø§Øª ÙÙŠ Ø§Ù„ÙˆÙ‚Øª Ø§Ù„ÙØ¹Ù„ÙŠ
const subscription = supabase
  .channel('evaluations-changes')
  .on('postgres_changes', {
    event: 'INSERT',
    schema: 'public',
    table: 'evaluations'
  }, (payload) => {
    console.log('ØªÙ‚ÙŠÙŠÙ… Ø¬Ø¯ÙŠØ¯:', payload.new)
    loadEvaluations() // Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„
  })
  .subscribe()

// Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ Ø¹Ù†Ø¯ unmount
return () => {
  subscription.unsubscribe()
}
```

---

## ğŸ“ Ù…ÙˆØ§Ø±Ø¯ ØªØ¹Ù„ÙŠÙ…ÙŠØ©

### Supabase
- [Docs](https://supabase.com/docs)
- [Row Level Security](https://supabase.com/docs/guides/auth/row-level-security)
- [JavaScript Client](https://supabase.com/docs/reference/javascript)

### React
- [React Docs](https://react.dev)
- [React Router](https://reactrouter.com)
- [Hooks Reference](https://react.dev/reference/react)

### Tailwind CSS
- [Documentation](https://tailwindcss.com/docs)
- [Cheat Sheet](https://nerdcave.com/tailwind-cheat-sheet)

### Recharts
- [Examples](https://recharts.org/en-US/examples)

---

## ğŸš€ Ø§Ù„Ø®Ø·ÙˆØ§Øª Ø§Ù„ØªØ§Ù„ÙŠØ©

Ø¨Ø¹Ø¯ Ø¥ÙƒÙ…Ø§Ù„ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØŒ ÙŠÙ…ÙƒÙ†Ùƒ:

1. **Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø²ÙŠØ¯ Ù…Ù† Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ø£Ø³Ø¦Ù„Ø©**
2. **ØªØ­Ø³ÙŠÙ† ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…**
3. **Ø¥Ø¶Ø§ÙØ© Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ**
4. **ØªØ·ÙˆÙŠØ± ØªØ·Ø¨ÙŠÙ‚ Ù…ÙˆØ¨Ø§ÙŠÙ„**
5. **Ø¥Ø¶Ø§ÙØ© Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… ØªÙ†ÙÙŠØ°ÙŠØ©**
6. **ØªÙƒØ§Ù…Ù„ Ù…Ø¹ Ø£Ù†Ø¸Ù…Ø© Ø£Ø®Ø±Ù‰**

---

**Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ«: 2026-02-01**
**Ø§Ù„Ù†Ø³Ø®Ø©: 1.0**
